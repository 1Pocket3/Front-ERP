# Интеграция лидов в Front-ERP

## Обзор

Этот документ описывает интеграцию системы управления лидами в Front-ERP приложение. Лиды заменяют проекты в качестве основного объекта управления.

## Структура файлов

### Новые страницы
- `pages/leads.vue` - Главная страница со списком лидов
- `pages/add-lead.vue` - Страница добавления нового лида
- `pages/edit-lead/[id].vue` - Страница редактирования лида
- `pages/lead/[id].vue` - Страница просмотра деталей лида

### Store
- `stores/leads/leads.ts` - Pinia store для управления состоянием лидов

### Обновленные файлы
- `locales/ru.js` - Добавлены переводы для лидов
- `components/vertical-sidebar/sidebarItem.ts` - Добавлена навигация к лидам
- `utils/axios.ts` - Настроен базовый URL для API

## API Endpoints

### Основные операции с лидами
- `GET /leads/list/` - Получение списка лидов с пагинацией и поиском
- `GET /leads/{id}/` - Получение лида по ID
- `POST /leads/` - Создание нового лида
- `PUT /leads/{id}/` - Обновление лида
- `DELETE /leads/{id}/` - Удаление лида

### Дополнительные операции
- `POST /leads/assign/` - Назначение лидов менеджерам
- `POST /leads/import/` - Импорт лидов из файла
- `POST /leads/import/preview/` - Предварительный просмотр импорта
- `GET /leads/import/history/` - История импортов
- `GET /leads/managers/` - Список менеджеров

### Новые эндпоинты для фронтенда
- `POST /upload/` - Загрузка файла
- `POST /process-import/` - Обработка загруженного файла
- `GET /import-status/{id}/` - Статус импорта
- `GET /user-imports/` - Импорты пользователя
- `DELETE /delete-import/{id}/` - Удаление импорта

## Функциональность

### Главная страница лидов (`/leads`)
- Таблица с пагинацией
- Поиск по имени, телефону, email
- Кнопки для добавления и импорта лидов
- Действия: просмотр, редактирование, удаление

### Добавление лида (`/add-lead`)
- Форма с валидацией
- Обязательные поля: имя, телефон
- Опциональные поля: фамилия, email, компания, источник

### Редактирование лида (`/edit-lead/{id}`)
- Предзаполненная форма
- Валидация данных
- Сохранение изменений

### Просмотр лида (`/lead/{id}`)
- Детальная информация о лиде
- Контактные данные
- Системная информация
- Дополнительные данные (если есть)
- Кнопки редактирования и удаления

## Настройка

### 1. Бэкенд
Убедитесь, что Django сервер запущен на `http://127.0.0.1:8000` и доступны все API эндпоинты.

### 2. Аутентификация
Перед использованием необходимо войти в систему через `/auth` для получения JWT токена.

### 3. Переменные окружения
Можно настроить базовый URL API через переменную окружения `API_BASE_URL`.

## Тестирование

### Автоматическое тестирование
Запустите тестовый скрипт в консоли браузера на странице `/leads`:

```javascript
// Скопируйте содержимое файла test-leads-integration.js в консоль браузера
```

### Ручное тестирование
1. Войдите в систему
2. Перейдите на страницу `/leads`
3. Проверьте загрузку списка лидов
4. Создайте новый лид
5. Отредактируйте лид
6. Удалите лид
7. Протестируйте импорт файла

## Особенности реализации

### Пагинация
- Серверная пагинация с настраиваемым размером страницы
- Поддержка навигации по страницам

### Поиск
- Поиск по имени, фамилии, телефону, email
- Поиск в реальном времени при вводе

### Импорт файлов
- Поддержка CSV и Excel файлов
- Предварительный просмотр данных
- Обработка ошибок валидации

### Валидация
- Клиентская валидация форм
- Проверка формата телефона и email
- Обязательные поля

### Обработка ошибок
- Централизованная обработка ошибок API
- Пользовательские уведомления
- Логирование ошибок в консоль

## Следующие шаги

1. Добавить фильтрацию по менеджерам
2. Реализовать массовые операции
3. Добавить экспорт данных
4. Улучшить UI/UX
5. Добавить аналитику и отчеты
